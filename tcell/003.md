# 后台事件处理

这里主要处理了两种事件:按键/窗口大小改变,
实现的方式是协程 + for循环 + select.

这块的事件处理分两阶段处理:

- 获取一个事件
- 做相应的处理

这点上和widnows上的小心循环事件处理是一个模式.

## 可以获取哪些事件

通过PollEvent()能获取哪些事件消息,
从源码可以看出,一类是退出消息,
一类是事件消息.

先看退出消息t.quit:

- 在t.Fini中会调用,这是结束清理操作
  - 通过closet.quit)来通知其他所有相关协程做退出处理
- t.PollEvent中会调用
  - 退出消息告诉了PollEvent
  - 这里是select,不会阻塞,不需要特殊处理
- 主循环 t.mainLoop()中会调用
  - 主循环收到退出消息后,做了两件事
    - 处理indoneq信道,确保退出顺序是正确的
    - 结束for循环,退出协程

从分析可以看出,t.quit只是结束时,通知其他协程退出的消息.

再看下事件消息:

t.evch, 这个信道元素的格式是Event(一个接口,可放多种不同的事件),
tScreen初始化时,evch是一个缓冲信道,数量是10,
tScreen提供了两种发送事件的方式(阻塞式和非阻塞式).
比如窗口resize消息走的是非阻塞,输入事件就是阻塞式的.

具体输入时如何处理的,后面再单独重新梳理.

## box业务上处理了哪些事件
